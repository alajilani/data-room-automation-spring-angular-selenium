{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/users.service\";\nimport * as i2 from \"../services/role.service\";\nimport * as i3 from \"primeng/button\";\nimport * as i4 from \"primeng/table\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"primeng/dialog\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"primeng/inputtext\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"primeng/checkbox\";\nimport * as i11 from \"primeng/multiselect\";\n\nfunction UsersComponent_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\")(2, \"div\", 21);\n    i0.ɵɵtext(3, \" First Name \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"th\")(5, \"div\", 21);\n    i0.ɵɵtext(6, \" Last Name \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"th\")(8, \"div\", 21);\n    i0.ɵɵtext(9, \" Username \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"th\")(11, \"div\", 21);\n    i0.ɵɵtext(12, \" Roles \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(13, \"th\", 22);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UsersComponent_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 23)(1, \"td\")(2, \"span\", 24);\n    i0.ɵɵtext(3, \"First Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"span\", 24);\n    i0.ɵɵtext(7, \"Last Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"span\", 24);\n    i0.ɵɵtext(11, \"Username\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\")(14, \"span\", 24);\n    i0.ɵɵtext(15, \"Roles\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"span\", 25);\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"td\", 26)(19, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function UsersComponent_ng_template_10_Template_button_click_19_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const user_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.showEditUserDialog(user_r6);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function UsersComponent_ng_template_10_Template_button_click_20_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const user_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.deleteUser(user_r6);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const user_r6 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", user_r6.firstName, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", user_r6.lastName, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", user_r6.username, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.userRolesToString(user_r6.roles));\n  }\n}\n\nfunction UsersComponent_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 29);\n    i0.ɵɵtext(2, \"No users found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction UsersComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"label\", 13);\n    i0.ɵɵtext(2, \"Update password :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p-checkbox\", 30);\n    i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_div_25_Template_p_checkbox_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.updatePassword = $event;\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r4.updatePassword)(\"binary\", true);\n  }\n}\n\nfunction UsersComponent_ng_template_39_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function UsersComponent_ng_template_39_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.displayAddUserModal = false;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(1, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function UsersComponent_ng_template_39_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.saveOrUpdateUser();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [10, 25, 50];\n};\n\nconst _c1 = function () {\n  return {\n    width: \"550px\"\n  };\n};\n\nconst _c2 = function (a0) {\n  return {\n    \"ng-invalid ng-dirty\": a0\n  };\n};\n\nexport let UsersComponent = /*#__PURE__*/(() => {\n  class UsersComponent {\n    constructor(userService, roleService) {\n      this.userService = userService;\n      this.roleService = roleService;\n      this.loading = true;\n      this.init = 0;\n      this.displayAddUserModal = false;\n      this.userSave = {\n        id: null,\n        firstName: \"\",\n        lastName: \"\",\n        password: \"\",\n        roles: [],\n        username: \"\",\n        confirmPassword: \"\"\n      };\n      this.roles = [];\n      this.updatePassword = false;\n      this.editUser = false;\n      this.originalUser = null;\n    }\n\n    ngOnInit() {\n      this.userService.getUsers().subscribe(users => {\n        this.users = users;\n        this.loading = false;\n        this.initUsers();\n      }, error => console.log(error));\n      this.roleService.getRoles().subscribe(roles => {\n        this.roles = roles;\n        this.initUsers();\n      }, error => console.log(error));\n    }\n\n    initUsers() {\n      this.init++;\n\n      if (this.init == 2) {\n        this.users.forEach(user => this.initUserRoles(user));\n      }\n    }\n\n    initUserRoles(user) {\n      let tempRoles = [];\n      user.roles.forEach(role => tempRoles.push(this.roles.find(r => r.id == role.id)));\n      user.roles = tempRoles;\n      return user;\n    }\n\n    showAddUserDialog() {\n      this.displayAddUserModal = true;\n      this.editUser = false;\n      this.userSave = {\n        id: null,\n        firstName: \"\",\n        lastName: \"\",\n        password: \"\",\n        roles: [],\n        username: \"\",\n        confirmPassword: \"\"\n      };\n    }\n\n    showEditUserDialog(user) {\n      this.displayAddUserModal = true;\n      this.editUser = true;\n      this.userSave.id = user.id;\n      this.userSave.roles = user.roles;\n      this.userSave.username = user.username;\n      this.userSave.firstName = user.firstName;\n      this.userSave.lastName = user.lastName;\n      this.updatePassword = false;\n      this.originalUser = user;\n    }\n\n    saveOrUpdateUser() {\n      if (this.editUser) {\n        console.log(\"editing\");\n        this.updateUser();\n      } else {\n        this.saveUser();\n      }\n    }\n\n    updateUser() {\n      let userEdit = {\n        updatePassword: this.updatePassword,\n        user: this.userSave\n      };\n      this.userService.updateUser(userEdit).subscribe(user => this.closeEditDialog(true, user), error => console.log(error));\n    }\n\n    saveUser() {\n      if (this.validUserSave()) {\n        this.userService.saveUser(this.userSave).subscribe(user => {\n          this.users.push(this.initUserRoles(user));\n          this.closeEditDialog(true);\n        }, error => console.log(error));\n      }\n    }\n\n    closeEditDialog(sucess, user) {\n      this.displayAddUserModal = false;\n\n      if (sucess === false) {\n        return;\n      }\n\n      if (user != null) {\n        this.originalUser.id = user.id;\n        this.originalUser.roles = user.roles;\n        this.originalUser.username = user.username;\n        this.originalUser.firstName = user.firstName;\n        this.originalUser.lastName = user.lastName;\n      }\n    }\n\n    validUserSave() {\n      return this.userSave != null && this.validUsername && this.validPassword() && this.confirmPassword();\n    }\n\n    confirmPassword() {\n      return this.userSave.password === this.userSave.confirmPassword;\n    }\n\n    validPassword() {\n      return this.userSave.password != \"\" && this.userSave.password != null;\n    }\n\n    validUsername() {\n      return this.userSave.username != \"\" && this.userSave.username != null;\n    }\n\n    userRolesToString(roles) {\n      let string = \"\";\n      roles.forEach(role => string += \",\" + role.name);\n      string = string.slice(1);\n      return string;\n    }\n\n    deleteUser(user) {\n      this.userService.deleteUser(user.id).subscribe(response => this.deleteLocalUser(user), error => console.log(error));\n    }\n\n    deleteLocalUser(user) {\n      let index = this.users.findIndex(u => u.id == user.id);\n\n      if (index > -1) {\n        this.users.splice(index, 1);\n      }\n    }\n\n  }\n\n  UsersComponent.ɵfac = function UsersComponent_Factory(t) {\n    return new (t || UsersComponent)(i0.ɵɵdirectiveInject(i1.UsersService), i0.ɵɵdirectiveInject(i2.RoleService));\n  };\n\n  UsersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UsersComponent,\n    selectors: [[\"app-users\"]],\n    decls: 40,\n    vars: 35,\n    consts: [[1, \"grid\"], [1, \"col-12\", \"header\"], [1, \"title\"], [1, \"buttons\"], [\"label\", \"Add User\", 3, \"click\"], [1, \"col-12\"], [\"scrollHeight\", \"calc(100vh - 1rem - 138px)\", \"responsiveLayout\", \"scroll\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"scrollable\", \"rowHover\", \"rows\", \"showCurrentPageReport\", \"rowsPerPageOptions\", \"loading\", \"paginator\"], [\"dt\", \"\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [3, \"header\", \"visible\", \"modal\", \"draggable\", \"resizable\", \"visibleChange\"], [1, \"form-group\", \"grid\"], [1, \"col-12\", \"md:col-4\"], [\"type\", \"text\", \"pInputText\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"pInputText\", \"\", 1, \"ng-invalid\", \"ng-dirty\", 3, \"ngClass\", \"ngModel\", \"ngModelChange\"], [\"class\", \"form-group grid\", 4, \"ngIf\"], [3, \"ngClass\"], [\"type\", \"password\", \"pInputText\", \"\", 1, \"ng-invalid\", \"ng-dirty\", 3, \"ngClass\", \"ngModel\", \"ngModelChange\"], [\"defaultLabel\", \"Select a Role\", \"optionLabel\", \"name\", 3, \"options\", \"ngModel\", \"ngModelChange\"], [\"pTemplate\", \"footer\"], [1, \"flex\", \"justify-content-between\", \"align-items-center\"], [2, \"max-width\", \"8rem\"], [1, \"p-selectable-row\"], [1, \"p-column-title\"], [1, \"image-text\"], [2, \"text-align\", \"center\", \"max-width\", \"8rem\"], [\"pButton\", \"\", \"type\", \"button\", \"icon\", \"pi pi-user-edit\", 1, \"p-button-primary\", 2, \"margin-right\", \"10px\", 3, \"click\"], [\"pButton\", \"\", \"type\", \"button\", \"icon\", \"pi pi-user-minus\", 1, \"p-button-danger\", 3, \"click\"], [\"colspan\", \"8\"], [\"inputId\", \"binary\", 1, \"col-12\", \"md:col-8\", 2, \"padding-left\", \"0\", 3, \"ngModel\", \"binary\", \"ngModelChange\"], [\"icon\", \"pi pi-times\", \"label\", \"Cancel\", \"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", 1, \"p-button-danger\", 3, \"click\"], [\"icon\", \"pi pi-check\", \"label\", \"Save\", \"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", 1, \"p-button-primary\", 3, \"click\"]],\n    template: function UsersComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2);\n        i0.ɵɵtext(3, \"Users\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 3)(5, \"p-button\", 4);\n        i0.ɵɵlistener(\"click\", function UsersComponent_Template_p_button_click_5_listener() {\n          return ctx.showAddUserDialog();\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"div\", 5)(7, \"p-table\", 6, 7);\n        i0.ɵɵtemplate(9, UsersComponent_ng_template_9_Template, 14, 0, \"ng-template\", 8);\n        i0.ɵɵtemplate(10, UsersComponent_ng_template_10_Template, 21, 4, \"ng-template\", 9);\n        i0.ɵɵtemplate(11, UsersComponent_ng_template_11_Template, 3, 0, \"ng-template\", 10);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(12, \"p-dialog\", 11);\n        i0.ɵɵlistener(\"visibleChange\", function UsersComponent_Template_p_dialog_visibleChange_12_listener($event) {\n          return ctx.displayAddUserModal = $event;\n        });\n        i0.ɵɵelementStart(13, \"div\", 12)(14, \"label\", 13);\n        i0.ɵɵtext(15, \"First Name :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_input_ngModelChange_16_listener($event) {\n          return ctx.userSave.firstName = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 12)(18, \"label\", 13);\n        i0.ɵɵtext(19, \"Last Name :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"input\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.userSave.lastName = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"div\", 12)(22, \"label\", 13);\n        i0.ɵɵtext(23, \"Username :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_input_ngModelChange_24_listener($event) {\n          return ctx.userSave.username = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(25, UsersComponent_div_25_Template, 4, 2, \"div\", 16);\n        i0.ɵɵelementStart(26, \"div\", 17)(27, \"div\", 12)(28, \"label\", 13);\n        i0.ɵɵtext(29, \"Password :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_input_ngModelChange_30_listener($event) {\n          return ctx.userSave.password = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(31, \"div\", 12)(32, \"label\", 13);\n        i0.ɵɵtext(33, \"Confirm Password :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"input\", 18);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_input_ngModelChange_34_listener($event) {\n          return ctx.userSave.confirmPassword = $event;\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(35, \"div\", 12)(36, \"label\", 13);\n        i0.ɵɵtext(37, \"Roles :\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"p-multiSelect\", 19);\n        i0.ɵɵlistener(\"ngModelChange\", function UsersComponent_Template_p_multiSelect_ngModelChange_38_listener($event) {\n          return ctx.userSave.roles = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(39, UsersComponent_ng_template_39_Template, 2, 0, \"ng-template\", 20);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"value\", ctx.users)(\"scrollable\", true)(\"rowHover\", true)(\"rows\", 10)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(27, _c0))(\"loading\", ctx.loading)(\"paginator\", true);\n        i0.ɵɵadvance(5);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(28, _c1));\n        i0.ɵɵproperty(\"header\", ctx.editUser ? \"Edit User\" : \"Add User\")(\"visible\", ctx.displayAddUserModal)(\"modal\", true)(\"draggable\", true)(\"resizable\", false);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.userSave.firstName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.userSave.lastName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(29, _c2, !ctx.validUsername()))(\"ngModel\", ctx.userSave.username);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.editUser);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngClass\", ctx.editUser && !ctx.updatePassword ? \"hide-password\" : \"show-password\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(31, _c2, !ctx.validPassword()))(\"ngModel\", ctx.userSave.password);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(33, _c2, !ctx.confirmPassword()))(\"ngModel\", ctx.userSave.confirmPassword);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"options\", ctx.roles)(\"ngModel\", ctx.userSave.roles);\n      }\n    },\n    directives: [i3.Button, i4.Table, i5.PrimeTemplate, i3.ButtonDirective, i6.Dialog, i7.DefaultValueAccessor, i8.InputText, i7.NgControlStatus, i7.NgModel, i9.NgClass, i9.NgIf, i10.Checkbox, i11.MultiSelect],\n    styles: [\".buttons[_ngcontent-%COMP%]{float:right}.buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin-right:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:10px}.title[_ngcontent-%COMP%]{font-size:30px;padding:2px 2px 2px 10px;border:none}.header[_ngcontent-%COMP%]{padding:20px 12px;border-bottom:1px solid;margin:0 8px;width:calc(100% - 8px)}.header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block}.grid[_ngcontent-%COMP%]{margin-top:0;width:100%}.form-group[_ngcontent-%COMP%]{padding-bottom:5px;margin:0}p-dialog[_ngcontent-%COMP%]     .p-dialog-content{padding-top:37px;overflow:visible}p-dialog[_ngcontent-%COMP%]     .p-dialog-header{padding:17px 24px;border-bottom:2px solid gray;background:aliceblue}p-dialog[_ngcontent-%COMP%]     .p-multiselect{width:14rem}.hide-password[_ngcontent-%COMP%]{max-height:0;transition:max-height .3s ease-out;overflow:hidden}.show-password[_ngcontent-%COMP%]{max-height:100vh;transition:max-height .5s ease-in;overflow:hidden}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{color:#fff;background-color:#191d35}p-table[_ngcontent-%COMP%]     .p-datatable-wrapper{border-radius:5px}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{border-bottom:1px solid #191d35}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:first-child{border-left:1px solid #191d35}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td:last-child{border-right:1px solid #191d35}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:last-child>td:first-child{border-bottom-left-radius:5px}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:last-child>td:last-child{border-bottom-right-radius:5px}\"]\n  });\n  return UsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}